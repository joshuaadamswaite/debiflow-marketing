<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DebiFlow</title>
  <meta name="description" content="DebiFlow runs per-receivable funding. Originators raise funding as they grow. Investors get enforceable security, clear cashflows, and a repeatable settlement pack." />
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <header class="topbar" id="top">
    <div class="container topbar-inner">
      <a class="brand" href="#top" aria-label="DebiFlow Home">
        <img class="brand-logo" src="assets/logo_white.svg" alt="DebiFlow"
             onerror="this.onerror=null; this.src='assets/logo.svg';" />
      </a>

      <nav class="nav" aria-label="Primary navigation">
        <div class="nav-links">
          <a class="nav-link" href="#how">How it works</a>
          <a class="nav-link" href="#cycle">The cycle</a>
          <a class="nav-link" href="#protections">Protections</a>
          <a class="nav-link" href="#run">Run it</a>
          <a class="nav-link" href="#start">Start</a>
        </div>

        <div class="nav-actions">
          <a class="btn btn-ghost" href="https://debiflow7-757013332927.africa-south1.run.app/login?next=/">Log in</a>
          <a class="btn btn-primary" href="#start">Book a demo</a>
        </div>
      </nav>

      <button class="nav-toggle" id="navToggle" aria-label="Open menu" aria-expanded="false">
        <span></span><span></span><span></span>
      </button>
    </div>

    <div class="mobile-nav" id="mobileNav" hidden>
      <div class="container mobile-nav-inner">
        <a class="mobile-link" href="#how">How it works</a>
        <a class="mobile-link" href="#cycle">The cycle</a>
        <a class="mobile-link" href="#protections">Protections</a>
        <a class="mobile-link" href="#run">Run it</a>
        <a class="mobile-link" href="#start">Start</a>

        <div class="mobile-actions">
          <a class="btn btn-ghost w-full" href="https://debiflow7-757013332927.africa-south1.run.app/login?next=/">Log in</a>
          <a class="btn btn-primary w-full" href="#start">Book a demo</a>
        </div>
      </div>
    </div>
  </header>

  <main>
    <section class="hero" aria-labelledby="hero-title">
      <div class="hero-bg" aria-hidden="true"></div>

      <div class="container hero-inner">
        <div class="hero-copy reveal">
          <div class="eyebrow">
            Infrastructure to support the next $5T in African loan disbursements by 2050.
            <span class="tip">
              <button class="q" type="button" aria-label="Estimate details">?</button>
              <span class="tooltip">
                <div class="tt-head"><span class="tt-head-label">Workings</span></div>

                <div class="tt-item">
                  • Africa consumer + business spending: ~<strong>$16.2T</strong> by 2050 <span class="tt-ref">[1]</span>
                </div>

                <div class="tt-item">
                  • Credit “scale” proxy: private-sector credit ≈ <strong>28% of GDP</strong> (2020 Africa avg) <span class="tt-ref">[2]</span>
                </div>

                <div class="tt-item">
                  <strong>Back-of-envelope:</strong> 16.2T × 28% ≈ <strong>$4.6T</strong> → rounds to <strong>$5T</strong>
                </div>

                <div class="tt-foot">
                  <span class="tt-ref">[1]</span>
                  <a href="https://www.brookings.edu/articles/africas-moment-to-shape-the-global-order/" target="_blank" rel="noopener">Brookings</a>
                  ·
                  <span class="tt-ref">[2]</span>
                  <a href="https://www.theglobaleconomy.com/rankings/domestic_credit_private_sector/Africa/" target="_blank" rel="noopener">World Bank WDI (compiled)</a>
                </div>
              </span>

            </span>
          </div>

          <h1 id="hero-title">DebiFlow helps lenders raise funding as they grow, while giving investors the security to invest with confidence.</h1>

          <p class="subhead">Converting any loan into an investible asset.</p>

          <div class="hero-actions">
            <a class="btn btn-primary" href="#start">Book a demo</a>
            <a class="text-link" href="#how">See how it works</a>
          </div>

          <div class="cycle-inline" aria-label="The cycle">
            <span class="cycle-label">The cycle</span>
            <span class="cycle-step">Upload</span>
            <span class="cycle-arrow">→</span>
            <span class="cycle-step">Allocate</span>
            <span class="cycle-arrow">→</span>
            <span class="cycle-step">Deploy</span>
            <span class="cycle-arrow">→</span>
            <span class="cycle-step">Track</span>
            <span class="cycle-arrow">→</span>
            <span class="cycle-step">Settle</span>
          </div>
        </div>
      </div>
    </section>

    <section class="proof" aria-label="Portfolio scale to date">
      <div class="container">
        <div class="proof-inner reveal">
          <div class="proof-title">Operations to date</div>
          <div class="stats" role="list">
            <div class="stat" role="listitem">
              <div class="stat-value">R66.1m</div>
              <div class="stat-label">Total investor repayments</div>
            </div>
            <div class="stat" role="listitem">
              <div class="stat-value">190k</div>
              <div class="stat-label">Receivables processed</div>
            </div>
            <div class="stat" role="listitem">
              <div class="stat-value">106.9k</div>
              <div class="stat-label">Unique contracts</div>
            </div>
            <div class="stat" role="listitem">
              <div class="stat-value">R11.8m</div>
              <div class="stat-label">Outstanding receivables</div>
            </div>
            <div class="stat" role="listitem">
              <div class="stat-value">13.1k</div>
              <div class="stat-label">Repurchases processed</div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="section alt" id="audience">
      <div class="container">
        <div class="section-head narrow reveal">
          <h2 class="h2">Built for originators and investors.</h2>
          <div class="note">Select your user role to see what we offer.</div>
        </div>

        <div class="role-select reveal" id="roleSelect" aria-label="Role benefits">
          <div class="role-table" role="region" aria-label="Select role">
            <table class="role-table-inner">
              <thead>
                <tr>
                  <th scope="col">Entity</th>
                  <th scope="col">Your role</th>
                  <th scope="col" class="role-th-open">Open</th>
                </tr>
              </thead>
              <tbody>
                <tr class="role-row is-selected" data-role="originator" tabindex="0">
                  <td class="role-entity">Lender Co. (Pty.) Ltd.</td>
                  <td><span class="role-pill">Originator</span></td>
                  <td class="role-open-cell">
                    <button class="role-open" type="button" data-role="originator" aria-controls="roleBenefits" aria-pressed="true">Open</button>
                  </td>
                </tr>

                <tr class="role-row" data-role="investor" tabindex="0">
                  <td class="role-entity">Investor Co. (Pty.) Ltd.</td>
                  <td><span class="role-pill">Investor</span></td>
                  <td class="role-open-cell">
                    <button class="role-open" type="button" data-role="investor" aria-controls="roleBenefits" aria-pressed="false">Open</button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <article class="panel role-benefits" id="roleBenefits" aria-live="polite">
            <div class="role-pane is-active" data-role="originator">
              <div class="kicker">For originators</div>
              <h3 class="h3">Raise as you grow</h3>
              <ul class="bullets">
                <li>Fund receivables one purchase at a time, without forcing risky deployment or admin burden.</li>
                <li>Predictable settlement for month-end pressure when salaries hit before collections clear.</li>
                <li>Segment what is investable by mandate, allocating each receivable to the best-fit investor.</li>
              </ul>
            </div>

            <div class="role-pane" data-role="investor">
              <div class="kicker">For investors</div>
              <h3 class="h3">A system you can trust</h3>
              <ul class="bullets">
                <li>Simple onboarding, shared security, and clean cashflow routing.</li>
                <li>Limits, triggers, and repurchase paths.</li>
                <li>Reconciled reporting, exception queues, audit trail.</li>
              </ul>
            </div>
          </article>
        </div>
      </div>
    </section>

    <section class="section" id="how">
      <div class="container">
        <div class="section-head reveal">
          <h2 class="h2">How it works</h2>
          <p class="p">DebiFlow runs receivables funding from contract to recovery. Controls, reporting, exceptions, and repurchases are built in.</p>
        </div>

                <div class="timeline reveal how-accordion" aria-label="How DebiFlow works">
          <details class="how-step" open>
            <summary class="how-summary">
              <span class="how-dot" aria-hidden="true"></span>
              <span class="how-title">Contract</span>
              <span class="how-chevron" aria-hidden="true"></span>
            </summary>
            <div class="how-body">Standardised facility agreements, pledged collection accounts, and security sharing documents create a smooth onboarding process for both originators and investors.</div>
          </details>

          <details class="how-step">
            <summary class="how-summary">
              <span class="how-dot" aria-hidden="true"></span>
              <span class="how-title">Upload</span>
              <span class="how-chevron" aria-hidden="true"></span>
            </summary>
            <div class="how-body">Originators upload recently disbursed receivables using predefined templates, up to the agreed funding limit. Exceptions that do not meet the eligibility criteria are flagged and excluded from the investible pool.</div>
          </details>

          <details class="how-step">
            <summary class="how-summary">
              <span class="how-dot" aria-hidden="true"></span>
              <span class="how-title">Allocate</span>
              <span class="how-chevron" aria-hidden="true"></span>
            </summary>
            <div class="how-body">Receivables are allocated across investors based on return, impact, or liquidity goals, ensuring optimal mandate fit and the lowest cost of funding for the originators.</div>
          </details>

          <details class="how-step">
            <summary class="how-summary">
              <span class="how-dot" aria-hidden="true"></span>
              <span class="how-title">Settle</span>
              <span class="how-chevron" aria-hidden="true"></span>
            </summary>
            <div class="how-body">As repayment data is received, DebiFlow calculates each investor’s entitlement and converts many receivable-level movements into a single settlement from the originator on the agreed cadence, aligned to each investor’s liquidity profile.</div>
          </details>

          <details class="how-step">
            <summary class="how-summary">
              <span class="how-dot" aria-hidden="true"></span>
              <span class="how-title">Recovery</span>
              <span class="how-chevron" aria-hidden="true"></span>
            </summary>
            <div class="how-body">DebiFlow manages the repurchase of past-due accounts and, if agreed protections are ever triggered, enforces the pledged accounts and security package to execute the payment waterfall, without waiting for lengthy insolvency proceedings.</div>
          </details>
        </div>
      </div>
    </section>

        <section class="band band-dark" id="cycle" aria-label="The cycle">
      <div class="band-bg" aria-hidden="true"></div>

      <div class="container">
        <div class="band-inner reveal">
          <div class="band-head">
            <h2 class="h2 on-dark">Cash and security pools, managed inside the facility.</h2>
            <p class="p on-dark-muted">From drawdown rules to settlement packs, DebiFlow keeps investor funds on hand or backed by high-quality receivables, while facility exposure stays within agreed limits.</p>
          </div>

          <div class="cycle-layout">
            <div>
              <div class="cycle-tabs" role="tablist" aria-label="Facility controls">
                <button class="chip is-active" type="button" data-stage="daily" aria-selected="true">Structure the facility</button>
                <button class="chip" type="button" data-stage="monthend" aria-selected="false">Run the float</button>
                <button class="chip" type="button" data-stage="settlement" aria-selected="false">Protect the security pool</button>
              </div>

              <div class="cycle-content" aria-live="polite">
                <div class="cycle-pane is-active" data-stage="daily" role="tabpanel">
                  <ul class="bullets on-dark tight">
                    <li>Agree drawdown rules, limits, and investor liquidity preferences.</li>
                    <li>Set maximum facility exposure, then calculate each period’s drawdown headroom after expected repayments.</li>
                    <li>Track utilisation and available headroom at all times.</li>
                  </ul>
                </div>

                <div class="cycle-pane" data-stage="monthend" role="tabpanel">
                  <ul class="bullets on-dark tight">
                    <li>Route in-flows and out-flows through the float account.</li>
                    <li>Process investor settlements on the agreed cadence, or redeploy cash into new drawdowns.</li>
                    <li>Keep cash-on-hand visibility at all times.</li>
                  </ul>
                </div>

                <div class="cycle-pane" data-stage="settlement" role="tabpanel">
                  <ul class="bullets on-dark tight">
                    <li>Enforce repurchases of arrear accounts to maintain collateral quality.</li>
                    <li>Keep the security pool aligned to eligibility rules and mandate limits.</li>
                    <li>Deliver reconciliations and reports for easy validation and evidence.</li>
                  </ul>
                </div>
              </div>
            </div>

            <div class="cycle-rail" aria-hidden="true">
              <div class="rail">
                <div class="rail-node is-active" data-stage="daily">
                  <div class="rail-dot"></div>
                  <div class="rail-label">Structure the facility</div>
                </div>
                <div class="rail-node" data-stage="monthend">
                  <div class="rail-dot"></div>
                  <div class="rail-label">Run the float</div>
                </div>
                <div class="rail-node" data-stage="settlement">
                  <div class="rail-dot"></div>
                  <div class="rail-label">Protect the security pool</div>
                </div>
                <div class="rail-line"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="section alt" id="protections">
      <div class="container">
        <div class="section-head reveal">
          <h2 class="h2">Protections that make receivables fundable.</h2>
          <p class="p">The right protections at the right time.</p>
        </div>

        <div class="prot-grid reveal">
          <article class="card">
            <h3 class="h3">Security and cashflows</h3>
            <ul class="bullets tight">
              <li>Security sharing across investors.</li>
              <li>
                Collections account pledge, cession
                <span class="tip">
                  <button class="q" type="button" aria-label="Definition of cession">?</button>
                  <span class="tooltip">A legal transfer of collection rights into the shared security pool.</span>
                </span>
              </li>
              <li>Settlement cadence built in.</li>
            </ul>
          </article>

          <article class="card">
            <h3 class="h3">Rules and triggers</h3>
            <ul class="bullets tight">
              <li>
                Covenants
                <span class="tip">
                  <button class="q" type="button" aria-label="Definition of covenant">?</button>
                  <span class="tooltip">A portfolio rule, like concentration limits, that must stay within agreed bounds.</span>
                </span>
              </li>
              <li>
                Triggers
                <span class="tip">
                  <button class="q" type="button" aria-label="Definition of trigger">?</button>
                  <span class="tooltip">A threshold that prompts action before issues become disputes.</span>
                </span>
              </li>
              <li>Eligibility rules per mandate.</li>
              <li>Breach alerts in the exception queue.</li>
            </ul>
          </article>

          <article class="card">
            <h3 class="h3">Operations and audit trail</h3>
            <ul class="bullets tight">
              <li>
                Repurchase workflow
                <span class="tip">
                  <button class="q" type="button" aria-label="Definition of repurchase">?</button>
                  <span class="tooltip">The originator buys back a receivable if it breaks rules or exits eligibility.</span>
                </span>
              </li>
              <li>Reconciled reporting every cycle.</li>
              <li>Audit trail from intake to settlement.</li>
            </ul>
          </article>
        </div>

        <details class="details reveal">
          <summary class="details-summary">See all protections</summary>
          <div class="details-body">
            <div class="two-col">
              <div class="list">
                <div class="li">Security sharing across multiple investors</div>
                <div class="li">Collections account pledge and cession</div>
                <div class="li">Cashflow routing and ownership records</div>
                <div class="li">Settlement cadence scheduling and packs</div>
              </div>
              <div class="list">
                <div class="li">Covenants and portfolio limits</div>
                <div class="li">Triggers and breach alerts</div>
                <div class="li">Exception queues with reasons</div>
                <div class="li">Repurchase register, review vs finalised</div>
                <div class="li">Audit trail, versioned inputs and outputs</div>
              </div>
            </div>
          </div>
        </details>
      </div>
    </section>

    <section class="section" id="run">
      <div class="container">
        <div class="run-layout reveal">
          <div class="run-head">
            <h2 class="h2">Run the cycle, without the scramble.</h2>
            <p class="p">One workflow for reporting, exceptions, repurchases, settlement.</p>
          </div>

          <div class="run-items">
            <div class="run-item">
              <div class="run-tag">Reporting</div>
              <div class="run-title">Reconciled outputs</div>
              <div class="run-text">Payment allocation, balances, statements, covenant snapshot.</div>
            </div>

            <div class="run-item">
              <div class="run-tag">Exceptions</div>
              <div class="run-title">Queues with reasons</div>
              <div class="run-text">Missing inputs, mismatches, out-of-mandate items, duplicates.</div>
            </div>

            <div class="run-item">
              <div class="run-tag">Repurchases</div>
              <div class="run-title">Review, then finalise</div>
              <div class="run-text">Mark for review, see impact, finalise and lock in.</div>
            </div>

            <div class="run-item">
              <div class="run-tag">Settlement</div>
              <div class="run-title">Close on cadence</div>
              <div class="run-text">Monthly or quarterly pack, sign-off, audit trail.</div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="section alt" id="outputs">
      <div class="container">
        <div class="section-head reveal">
          <h2 class="h2">A reporting pack you can send.</h2>
          <p class="p">Same cadence. Same logic. Every period.</p>
          <div class="note">No twelve-tab spreadsheet required.</div>
        </div>

        <div class="pack reveal">
          <div class="pack-left card">
            <h3 class="h3">Outputs</h3>
            <ul class="bullets">
              <li>Allocation register by investor and mandate</li>
              <li>Debt register for the funded pool</li>
              <li>Payment allocation schedule</li>
              <li>Arrears and buckets</li>
              <li>Covenants, limits, triggers report</li>
              <li>Repurchase register, review vs finalised</li>
              <li>Settlement statement and period close pack</li>
            </ul>
          </div>

          <div class="pack-right">
            <div class="callout">
              <div class="callout-title">Designed for scanning</div>
              <ul class="bullets tight">
                <li>Concrete nouns. Consistent formats.</li>
                <li>Exceptions listed with reasons.</li>
                <li>Versioned inputs. Reproducible outputs.</li>
                <li>Downloadable packs for sharing.</li>
              </ul>
            </div>

            <div class="callout soft">
              <div class="callout-title">Settle with confidence</div>
              <div class="callout-text">The pack is the same shape every time. That is the point.</div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="section" id="start">
      <div class="container">
        <div class="section-head reveal">
          <h2 class="h2">Start small. Scale clean.</h2>
          <p class="p">If you have <strong>R500k+</strong> in live receivables, you’re in range.</p>
        </div>

        <div class="start-grid reveal">
          <div class="card">
            <h3 class="h3">What you bring</h3>
            <ul class="bullets">
              <li>Loan tape export and receivables schedule</li>
              <li>Repayment file or export</li>
              <li>Investor mandates (or a first draft)</li>
              <li>A collections account for repayments</li>
            </ul>
          </div>

          <div class="card card-soft">
            <h3 class="h3">What DebiFlow sets up</h3>
            <ul class="bullets">
              <li>Data mapping and validation</li>
              <li>Mandate rules and allocation templates</li>
              <li>Cadence and settlement pack structure</li>
              <li>First reconciled run</li>
            </ul>

            <div class="cta-row">
              <a class="btn btn-primary" href="mailto:info@debiflow.com?subject=DebiFlow%20demo%20request">Book a demo</a>
              <a class="btn btn-outline" href="https://debiflow7-757013332927.africa-south1.run.app/login?next=/">Log in</a>
            </div>

            <div class="mini-note">Prefer email, send a sample tape and we’ll reply with next steps.</div>
          </div>
        </div>

        <div class="closing reveal" id="about">
          <div class="closing-copy">
            <h2 class="h2">Built in South Africa, for real portfolios.</h2>
            <p class="p">DebiFlow was built to run receivables funding with repeatable reporting, clear protections, and predictable settlement. Calm month-ends are a feature.</p>
          </div>

          <div class="closing-banner">
            <div class="banner-kicker">Next step</div>
            <div class="banner-title">See DebiFlow on your data</div>
            <div class="banner-text">Share a sample loan tape and we’ll show your cycle, protections, and the reporting pack you’d send.</div>
            <div class="banner-actions">
              <a class="btn btn-primary" href="mailto:info@debiflow.com?subject=DebiFlow%20sample%20tape">Book a demo</a>
              <a class="btn btn-ghost" href="https://debiflow7-757013332927.africa-south1.run.app/login?next=/">Log in</a>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="container footer-inner">
      <div class="footer-left">
        <div class="footer-brand">DebiFlow</div>
        <div class="footer-muted">Receivables funding, run properly.</div>
      </div>

      <div class="footer-right">
        <a class="footer-link" href="mailto:info@debiflow.com">info@debiflow.com</a>
        <a class="footer-link" href="https://debiflow7-757013332927.africa-south1.run.app/login?next=/">Log in</a>
        <a class="footer-link" href="#top">Back to top</a>
      </div>
    </div>

    <div class="container footer-bottom">
      <div class="footer-fine">© 2026 DebiFlow</div>
    </div>
  </footer>

  <script>
    // Mobile menu
    const btn = document.getElementById("navToggle");
    const panel = document.getElementById("mobileNav");

    function closeMenu() {
      btn.setAttribute("aria-expanded", "false");
      panel.hidden = true;
      document.body.classList.remove("no-scroll");
    }

    btn.addEventListener("click", () => {
      const isOpen = btn.getAttribute("aria-expanded") === "true";
      btn.setAttribute("aria-expanded", String(!isOpen));
      panel.hidden = isOpen;
      document.body.classList.toggle("no-scroll", !isOpen);
    });

    document.querySelectorAll(".mobile-link").forEach(a => {
      a.addEventListener("click", closeMenu);
    });

    // Subtle reveal on scroll
    const prefersReduced = window.matchMedia("(prefers-reduced-motion: reduce)").matches;
    if (!prefersReduced) {
      const els = document.querySelectorAll(".reveal");
      const io = new IntersectionObserver((entries) => {
        entries.forEach(e => {
          if (e.isIntersecting) e.target.classList.add("is-in");
        });
      }, { threshold: 0.12 });
      els.forEach(el => io.observe(el));
    } else {
      document.querySelectorAll(".reveal").forEach(el => el.classList.add("is-in"));
    }

    // Cadence tabs
    const band = document.getElementById("cycle");
    function setStage(stage) {
      const chips = band.querySelectorAll(".chip");
      const panes = band.querySelectorAll(".cycle-pane");
      const nodes = band.querySelectorAll(".rail-node");
      chips.forEach(c => {
        const active = c.getAttribute("data-stage") === stage;
        c.classList.toggle("is-active", active);
        c.setAttribute("aria-selected", active ? "true" : "false");
      });
      panes.forEach(p => p.classList.toggle("is-active", p.getAttribute("data-stage") === stage));
      nodes.forEach(n => n.classList.toggle("is-active", n.getAttribute("data-stage") === stage));
    }

    if (band) {
      band.querySelectorAll(".chip").forEach(b => {
        b.addEventListener("click", () => setStage(b.getAttribute("data-stage")));
      });
    }

    // Role select toggles (Audience)
    const roleSelect = document.getElementById("roleSelect");
    if (roleSelect) {
      const rows = Array.from(roleSelect.querySelectorAll(".role-row"));
      const buttons = Array.from(roleSelect.querySelectorAll(".role-open"));
      const panes = Array.from(roleSelect.querySelectorAll(".role-pane"));

      function setRole(role) {
        rows.forEach(r => r.classList.toggle("is-selected", r.getAttribute("data-role") === role));
        buttons.forEach(b => b.setAttribute("aria-pressed", b.getAttribute("data-role") === role ? "true" : "false"));
        panes.forEach(p => p.classList.toggle("is-active", p.getAttribute("data-role") === role));
      }

      buttons.forEach(b => {
        b.addEventListener("click", (e) => {
          e.stopPropagation();
          setRole(b.getAttribute("data-role"));
        });
      });

      rows.forEach(r => {
        r.addEventListener("click", () => setRole(r.getAttribute("data-role")));
        r.addEventListener("keydown", (e) => {
          if (e.key === "Enter" || e.key === " ") {
            e.preventDefault();
            setRole(r.getAttribute("data-role"));
          }
        });
      });

      const defaultRole = (roleSelect.querySelector(".role-row.is-selected")?.getAttribute("data-role")) || "originator";
      setRole(defaultRole);
    }

    // How it works accordion (Option A: single-open)
    const how = document.getElementById("how");
    if (how) {
      const steps = Array.from(how.querySelectorAll("details.how-step"));
      if (steps.length) {
        const mqMobile = window.matchMedia("(max-width: 760px)");

        function setDefaults() {
          if (mqMobile.matches) {
            steps.forEach(d => d.removeAttribute("open"));
          } else {
            steps.forEach((d, i) => {
              if (i === 0) d.setAttribute("open", "");
              else d.removeAttribute("open");
            });
          }
        }

        setDefaults();

        // Keep defaults consistent if viewport changes
        const mqHandler = () => setDefaults();
        if (typeof mqMobile.addEventListener === "function") {
          mqMobile.addEventListener("change", mqHandler);
        } else if (typeof mqMobile.addListener === "function") {
          mqMobile.addListener(mqHandler);
        }

        // Ensure only one step is expanded at a time
        steps.forEach(d => {
          d.addEventListener("toggle", () => {
            if (!d.open) return;
            steps.forEach(other => {
              if (other !== d) other.open = false;
            });
          });
        });
      }
    }
  </script>
</body>
</html> 
 